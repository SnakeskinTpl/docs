<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" content="">
    <title>Документация Snakeskin 7</title>
    <link rel="stylesheet" type="text/css" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <script type="text/javascript" src="http://yastatic.net/jquery/2.2.0/jquery.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700|Open+Sans+Condensed:700&subset=latin,latin-ext,cyrillic,cyrillic-ext">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,700,400italic,700italic&subset=latin,cyrillic,cyrillic-ext,latin-ext">
    <link rel="stylesheet" type="text/css" href="css/highlight/default.css">
    <link rel="stylesheet" type="text/css" href="css/index.css">
    <script type="text/javascript" src="js/jquery.scrollTo.min.js"></script>
    <script type="text/javascript" src="js/index.js"></script>
</head>

<body>
    <div class="b-doc-wrapper">
        <header class="b-header">
            <a class="b-header__logo" href="index.html"><img src="logo.svg" alt="snakeskin template engine">
                <div class="b-header__logo-text">nakeskin</div>
            </a>
            <nav class="b-nav">
                <menu>
                    <li><strong>Документация</strong> </li>
                    <li><a id="api" href="api.html" label="API">API</a></li>
                    <li><a id="plugins" href="#" label="Плагины">Плагины</a></li>
                    <li><a id="examples" href="#" label="Примеры">Примеры</a></li>
                    <li><a id="sandbox" href="http://codepen.io/kobezzza/pen/zrJNXx" label="Песочница" target="_blank">Песочница</a></li>
                </menu>
            </nav>
        </header>
        <div class="b-content-wrapper">
            <nav class="b-contents">
                <ol>
                    <li class="b-contents__part b-contents__part_link_false">Введение
                        <ol>
                            <li class="b-contents__part b-contents__part_link_true"><a class="b-contents__link" href="#intro">Что такое Snakeskin</a> </li>
                            <li class="b-contents__part b-contents__part_link_true"><a class="b-contents__link" href="#concept">Общая концепция шаблонов Snakeskin</a> </li>
                        </ol>
                    </li>
                    <li class="b-contents__part b-contents__part_link_false">Основы
                        <ol>
                            <li class="b-contents__part b-contents__part_link_true"><a class="b-contents__link" href="#filters">Механизм фильтров</a> </li>
                        </ol>
                    </li>
                </ol>
            </nav>
            <div class="b-articles">
                <div class="b-articles__nav-cont b-articles__prev">
                    <div class="b-articles__nav-control"><i class="fa fa-angle-left"></i></div>
                </div>
                <section id="intro" class="b-article">
                    <ul class="b-breadcrumbs">
                        <li><i class="fa fa-home"></i>
                            <div class="fa fa-angle-right"></div> Введение </li>
                    </ul>
                    <h1>Что такое Snakeskin</h1>
                    <p>Snakeskin — это язык шаблонов и движок для их трансляции в JavaScript. Мощный набор возможностей и развитая защита от уязвимостей типа <a href="http://ru.wikipedia.org/wiki/%D0%9C%D0%B5%D0%B6%D1%81%D0%B0%D0%B9%D1%82%D0%BE%D0%B2%D1%8B%D0%B9_%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82%D0%B8%D0%BD%D0%B3">XSS</a>                        позволяют полностью сосредоточиться на представлении данных, делая его независимым от бизнес-логики. Таким образом, Snakeskin идеально подходит для ситуаций, когда бэкенд и фронтенд разработчики работают параллельно.</p>
                    <p>Благодаря тому, что шаблоны Snakeskin транслируются в JS-код стандарта ECMAScript 5, независимый от окружения, он одинаково хорошо подходит для использования как на стороне сервера, так и на клиенте. Это можно сравнить с принципом
                        работы <a href="https://ru.wikipedia.org/wiki/CoffeeScript">CoffeeScript</a>, но если CoffeeScript спроектирован для упрощения разработки сложных проектов непосредственно на JS, то Snakeskin предназначен для шаблонизации HTML/XML-подобных
                        структур и упрощения их код-реюза, предоставляя из коробки наследование, расширение, локализацию, экранирование и прочие полезные ништяки :)</p>
                    <p>Snakeskin удобно использовать для генерации статичных страниц — транслятор может скомпилировать и сразу выполнить шаблон, возвратив результат его работы, что удобно использовать для генерации шаблонов для различных MVVM-фреймворков,
                        таких как Angular, Vue или React. В принципе, можно использовать Snakeskin даже для генерации кода на PHP — но помните, мы не гарантируем защиты от динозавров, которые могут прийти за вами.</p>
                    <p>Snakeskin поддерживает интеграцию с популярными task-runnerʼами и сборщиками, такими как Grunt, Gulp или Webpack с помощью плагинов — это позволяет бесшовно встроить его в систему сборки любого проекта.</p>
                    <p>Use and enjoy.</p>
                </section>
                <section id="concept" class="b-article">
                    <ul class="b-breadcrumbs">
                        <li><i class="fa fa-home"></i>
                            <div class="fa fa-angle-right"></div> Введение </li>
                    </ul>
                    <h1>Общая концепция шаблонов Snakeskin</h1>
                    <p>Шаблоны в Snakeskin — это функции в JavaScript.</p>
                    <div class="b-example">
                        <menu class="b-example__toggle">
                            <li class="b-example__link b-example__link_active_true">jade-like</li>
                            <li class="b-example__link">classic</li>
                        </menu>
                        <div class="b-example__code">
                            <pre class="hljs example-jade-like"><code><span class="xml"></span><span class="hljs-directive">- <span class="hljs-name"><span class="hljs-built_in">namespace</span></span> demo</span><span class="xml">
</span><span class="hljs-directive">- <span class="hljs-name"><span class="hljs-built_in">template</span></span> helloWorld(name = <span class="hljs-string">'world'</span>)</span><span class="xml">
	Hello </span><span class="hljs-directive">{name}</span><span class="xml">!
</span></code></pre>
                            <pre class="hljs example-classic"><code><span class="xml"></span><span class="hljs-directive">{<span class="hljs-name"><span class="hljs-built_in">namespace</span></span> demo}</span><span class="xml">
</span><span class="hljs-directive">{<span class="hljs-name"><span class="hljs-built_in">template</span></span> helloWorld(name = <span class="hljs-string">'world'</span>)}</span><span class="xml">
	Hello </span><span class="hljs-directive">{name}</span><span class="xml">!
</span><span class="hljs-directive">{<span class="hljs-name">/<span class="hljs-built_in">template</span></span>}</span><span class="xml">
</span></code></pre>
                        </div>
                    </div>
                    <p>Эквивалентно</p>
                    <pre class="hljs example-js"><code><span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> demo === <span class="hljs-string">'undefined'</span>) {
	<span class="hljs-keyword">var</span> demo = {};
}

demo.helloWorld = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">helloWorld</span>(<span class="hljs-params">name</span>) </span>{
	<span class="hljs-keyword">return</span> <span class="hljs-string">'Hello '</span> + <span class="hljs-built_in">escape</span>(name) + <span class="hljs-string">'!'</span>;
}
</code></pre>
                    <p>После компиляции вызов шаблона соответствует простому вызову функции. Такой же подход используется в <a href="https://developers.google.com/closure/templates/">Google Closure Templates</a>.</p>
                </section>
                <section id="filters" class="b-article">
                    <ul class="b-breadcrumbs">
                        <li><i class="fa fa-home"></i>
                            <div class="fa fa-angle-right"></div> Основы </li>
                    </ul>
                    <h1>Механизм фильтров</h1>
                    <h2>Общая концепция</h2>
                    <p>Фильтром Snakeskin называется функция, которая лежит в пространстве имён <strong>Snakeskin.Filters</strong>, а для вызова такой функции используется специальный «сахарный» синтаксис. Сам механизм фильтров идеологически близок к реализации
                        в Bash, т. е. для вызова фильтра используется символ вертикальной черты (<code>|</code>), после которого идёт название фильтра и его параметры. Следует отметить, что между символом фильтра и названием не должно быть пробелов, иначе
                        это будет трактоваться парсером как «побитовое или».</p>
                    <p>Например:</p>
                    <pre class="hljs example-classic"><code><span class="xml"></span><span class="hljs-comment">/// Snakeskin.Filters['ucfirst'].call(this, 'hello' + ' world')</span><span class="xml">
</span><span class="hljs-directive">{<span class="hljs-string">'hello'</span> + <span class="hljs-string">' world'</span><span class="hljs-keyword">|ucfirst</span>}</span><span class="xml">
</span></code></pre>
                    <p>Как и в Bash, фильтры Snakeskin могут создавать конвейерные последовательности:</p>
                    <pre class="hljs example-classic"><code><span class="xml"></span><span class="hljs-directive">{<span class="hljs-string">' hello '</span><span class="hljs-keyword">|trim</span><span class="hljs-keyword">|ucfirst</span>}</span><span class="xml">
</span></code></pre>
                    <p>Фильтры можно накладывать отдельно на некоторые части выражения, для этого нужно обернуть декларацию в круглые скобки:</p>
                    <pre class="hljs example-classic"><code><span class="xml"></span><span class="hljs-comment">/// Два локальных и один глобальный фильтр,</span><span class="xml">
</span><span class="hljs-comment">/// который применится на всё выражение</span><span class="xml">
</span><span class="hljs-directive">{(a<span class="hljs-keyword">|ucfirst</span>) + (b<span class="hljs-keyword">|ucfirst</span>) <span class="hljs-keyword">|trim</span>}</span><span class="xml">
</span></code></pre>
                    <p>Фильтрам можно передавать параметры, на которые также можно применять фильтры и т. д.</p>
                    <pre class="hljs example-classic"><code><span class="xml"></span><span class="hljs-directive">{a<span class="hljs-keyword">|myFilter</span> <span class="hljs-number">1</span>, (<span class="hljs-number">2</span> / <span class="hljs-number">3</span><span class="hljs-keyword">|myFilter</span>)}</span><span class="xml">
</span></code></pre>
                    <p>По умолчанию при выводе значений через <a href="#output">output</a> к ним применяется глобальный фильтр html (экранирование html символов) и фильтр undef (замена <code>undefined</code> на пустые строки), однако их выполнение можно
                        отменить <code>{a|!html}</code> и <code>{a|!undef}</code>.</p>
                    <p>Механизм фильтров поддерживает большинство директив Snakeskin, например:</p>
                    <div class="b-example">
                        <menu class="b-example__toggle">
                            <li class="b-example__link b-example__link_active_true">jade-like</li>
                            <li class="b-example__link">classic</li>
                        </menu>
                        <div class="b-example__code">
                            <pre class="hljs example-jade-like"><code><span class="xml"></span><span class="hljs-directive">- <span class="hljs-name"><span class="hljs-built_in">var</span></span> a = <span class="hljs-string">'fooo '</span><span class="hljs-keyword">|trim</span></span><span class="xml">
</span><span class="hljs-directive">
- <span class="hljs-name"><span class="hljs-built_in">if</span></span> a<span class="hljs-keyword">|trim</span></span><span class="xml">
	...
</span></code></pre>
                            <pre class="hljs example-classic"><code><span class="xml"></span><span class="hljs-directive">{<span class="hljs-name"><span class="hljs-built_in">var</span></span> a = <span class="hljs-string">'fooo '</span><span class="hljs-keyword">|trim</span>}</span><span class="xml">

</span><span class="hljs-directive">{<span class="hljs-name"><span class="hljs-built_in">if</span></span> a<span class="hljs-keyword">|trim</span>}</span><span class="xml">
	...
</span><span class="hljs-directive">{/}</span><span class="xml">
</span></code></pre>
                        </div>
                    </div>
                    <p>Чтобы написать свой фильтр, достаточно добавить его в <em>Snakeskin.Filters</em>. Название фильтра может начинаться с символа латинского алфавита, подчёркивания (<code>_</code>) и знака доллара (<code>$</code>). Первым параметром функции
                        будет значение выражения, а <em>this</em> внутри фильтра ссылается на <em>this</em> шаблона.</p>
                    <pre class="hljs example-js"><code>Snakeskin.Filters[<span class="hljs-string">'replace'</span>] = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">str, search, replace</span>) </span>{
	<span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>(str).replace(search, replace);
};
</code></pre>
                    <p>Фильтры можно разбивать на внутренние пространства имён:</p>
                    <pre class="hljs example-js"><code>Snakeskin.Filters[<span class="hljs-string">'text'</span>] = {
	<span class="hljs-string">'replace'</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">str, search, replace</span>) </span>{
		<span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>(str).replace(search, replace);
	}
};
</code></pre>
                    <pre class="hljs example-classic"><code><span class="xml"></span><span class="hljs-directive">{<span class="hljs-string">'foo'</span><span class="hljs-keyword">|text</span>.replace <span class="hljs-string">'fo'</span>, <span class="hljs-string">'bar'</span>}</span><span class="xml">
</span></code></pre>
                    <p>Также для добавления своих фильтров можно воспользоваться методов
                        <a href="https://github.com/SnakeskinTpl/Snakeskin/blob/master/src/live/filters.js#L22">Snakeskin.importFilters</a>:</p>
                    <pre class="hljs example-js"><code>Snakeskin.importFilters({
	<span class="hljs-string">'replace'</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">str, search, replace</span>) </span>{
		<span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>(str).replace(search, replace);
	}
});

<span class="hljs-comment">// С указанием пространства имён</span>
<span class="hljs-comment">// my.foo.bar.repeat</span>
Snakeskin.importFilters({
	<span class="hljs-string">'replace'</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">str, search, replace</span>) </span>{
		<span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>(str).replace(search, replace);
	}
}, <span class="hljs-string">'my.foo.bar'</span>);
</code></pre>
                    <h3>Дополнительные параметры фильтров</h3>
                    <p>При декларации фильтра ему можно задать ряд дополнительных параметров, например, чтобы фильтр отменял выполнение фильтров по умолчанию. Для этого используется специальный метод
                        <a href="https://github.com/SnakeskinTpl/Snakeskin/blob/master/src/live/filters.js#L46">Snakeskin.setFilterParams</a>, который первым параметром принимает название фильтра, а вторым объект с настройками.</p>
                    <pre class="hljs example-js"><code>Snakeskin.importFilters({
	myFilter: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">str, getTplResult</span>) </span>{
		<span class="hljs-keyword">return</span> str + getTplResult();
	}
});

Snakeskin.setFilterParams(<span class="hljs-string">'myFilter'</span>, {
	<span class="hljs-comment">// Прокидываем функцию getTplResult из шаблона в фильтр</span>
	bind: [<span class="hljs-string">'getTplResult'</span>],

	<span class="hljs-comment">// Отменяем фильтр html по умолчанию</span>
	<span class="hljs-string">'!html'</span>: <span class="hljs-literal">true</span>,

	<span class="hljs-comment">// Отменяем фильтр undef по умолчанию</span>
	<span class="hljs-string">'!undef'</span>: <span class="hljs-literal">true</span>
});
</code></pre>
                    <p>Обратите внимание, что такие параметры должны задаваться <strong>до</strong> трансляции шаблона.</p>
                    <h3>Переменная $_</h3>
                    <p>Переменная <strong>$_</strong> содержит результат последней работы фильтра.</p>
                    <pre class="hljs example-classic"><code><span class="xml"></span><span class="hljs-directive">{<span class="hljs-string">' fooo '</span><span class="hljs-keyword">|trim</span>}</span><span class="xml">
</span><span class="hljs-directive">{$_}</span><span class="xml"> </span><span class="hljs-comment">/// 'fooo'</span><span class="xml">
</span></code></pre>
                    <h3>Примечание</h3>
                    <p>Чтобы использовать в шаблоне побитовое ИЛИ (<code>|</code>) достаточно просто указать пробел после оператора <code>|</code>, также если после оператора <code>|</code> идёт число, то можно писать как есть, т. к. название фильтра не может
                        начинаться с числа.</p>
                    <pre class="hljs example-default"><code>{<span class="hljs-number">1</span>|<span class="hljs-number">0</span>}

{a = <span class="hljs-number">1</span>}
{<span class="hljs-number">1</span> | a}
</code></pre>
                    <h3>Встроенные фильтры</h3>
                    <p>В стандартном runtime библиотеки Snakeskin присутствует ряд базовых фильтров, которые могут быть полезны при разработке шаблонов, <a href="https://github.com/SnakeskinTpl/Snakeskin/blob/master/src/live/filters.js">подробнее</a>.</p>
                </section>
                <div class="b-articles__nav-cont b-articles__next">
                    <div class="b-articles__nav-control"><i class="fa fa-angle-right"></i></div>
                </div>
            </div>
        </div>
        <footer class="b-footer">© 2016 Snakeskin
            <menu class="b-footer__menu">
                <li><a href="https://github.com/SnakeskinTpl/snakeskin.github.io/issues/new">Сообщить об ошибке</a></li>
                <li><a href="https://github.com/SnakeskinTpl/Snakeskin">GitHub</a></li>
            </menu>
        </footer>
    </div>
</body>

</html>
